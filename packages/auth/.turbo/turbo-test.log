
> test
> node --test --test-force-exit dist/**/*.test.js

TAP version 13
# Subtest: verifyAccessToken accepts a valid token
ok 1 - verifyAccessToken accepts a valid token
  ---
  duration_ms: 5.3177
  type: 'test'
  ...
# Subtest: verifyAccessToken rejects issuer mismatch
ok 2 - verifyAccessToken rejects issuer mismatch
  ---
  duration_ms: 0.9776
  type: 'test'
  ...
# Subtest: verifyAccessToken rejects exp at current time
ok 3 - verifyAccessToken rejects exp at current time
  ---
  duration_ms: 0.9195
  type: 'test'
  ...
# Subtest: verifyAccessToken rejects missing required claims
ok 4 - verifyAccessToken rejects missing required claims
  ---
  duration_ms: 0.7457
  type: 'test'
  ...
# Subtest: verifyAccessToken rejects wrong header values even if signature matches
ok 5 - verifyAccessToken rejects wrong header values even if signature matches
  ---
  duration_ms: 0.9391
  type: 'test'
  ...
# Subtest: verifyAccessToken rejects signature mismatch
ok 6 - verifyAccessToken rejects signature mismatch
  ---
  duration_ms: 0.7224
  type: 'test'
  ...
# Subtest: verifyAccessToken rejects malformed tokens
ok 7 - verifyAccessToken rejects malformed tokens
  ---
  duration_ms: 0.5285
  type: 'test'
  ...
# Subtest: requireInstitutionApiKey: missing key returns 401
ok 8 - requireInstitutionApiKey: missing key returns 401
  ---
  duration_ms: 391.8164
  type: 'test'
  ...
# Subtest: requireInstitutionApiKey: valid key sets req.institution
ok 9 - requireInstitutionApiKey: valid key sets req.institution
  ---
  duration_ms: 44.6117
  type: 'test'
  ...
# Subtest: verifyTwoFactorOrThrow returns used backup code hash when valid
ok 10 - verifyTwoFactorOrThrow returns used backup code hash when valid
  ---
  duration_ms: 7.167
  type: 'test'
  ...
# Subtest: verifyTwoFactorOrThrow throws invalid_twofa on bad codes
ok 11 - verifyTwoFactorOrThrow throws invalid_twofa on bad codes
  ---
  duration_ms: 1.7571
  type: 'test'
  ...
1..11
# tests 11
# suites 0
# pass 11
# fail 0
# cancelled 0
# skipped 0
# todo 0
# duration_ms 2612.0026
