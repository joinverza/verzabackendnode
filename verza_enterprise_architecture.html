<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verza Enterprise Architecture Blueprint</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-color: #f0f2f5;
            --zone-public: #e3f2fd;
            --zone-dmz: #fff3e0;
            --zone-app: #f1f8e9;
            --zone-data: #f3e5f5;
            --border-color: #b0bec5;
            --text-dark: #263238;
            --text-muted: #546e7a;
            --primary: #1565c0; /* Enterprise Blue */
            --accent: #2e7d32; /* Success Green */
            --admin-color: #c62828; /* Admin Red */
        }

        body {
            font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-dark);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            width: 100%;
            max-width: 1600px;
        }
        .header h1 { margin: 0; font-size: 2.2rem; color: var(--primary); text-transform: uppercase; letter-spacing: 1px; }
        .header p { margin: 5px 0 0; color: var(--text-muted); font-size: 1rem; }

        .legend {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            font-size: 0.85rem;
            background: white;
            padding: 10px 20px;
            border-radius: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .legend-item { display: flex; align-items: center; gap: 8px; }
        .dot { width: 10px; height: 10px; border-radius: 50%; }
        .line-sample { width: 30px; height: 2px; background: #999; }
        .line-dashed { border-top: 2px dashed #999; height: 0; width: 30px; background: none; }

        /* Main Diagram Layout */
        .diagram {
            display: grid;
            grid-template-columns: 250px 1fr 250px;
            gap: 30px;
            width: 100%;
            max-width: 1800px;
            position: relative;
        }

        /* Zones */
        .zone {
            border: 2px dashed var(--border-color);
            border-radius: 12px;
            padding: 20px;
            position: relative;
            background: white;
        }
        .zone-label {
            position: absolute;
            top: -12px;
            left: 20px;
            background: #37474f;
            color: white;
            padding: 4px 12px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            border-radius: 4px;
            z-index: 5;
        }

        /* Left Column: Consumers */
        .consumers-col {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .consumer-group {
            background: #fff;
            border: 1px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .consumer-group h3 { margin: 0 0 10px 0; font-size: 1rem; color: var(--primary); border-bottom: 1px solid #eee; padding-bottom: 5px; }

        .actor {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px;
            background: #f5f7fa;
            border-radius: 6px;
            margin-bottom: 10px;
            border-left: 4px solid #ccc;
            transition: transform 0.2s;
        }
        .actor:hover { transform: translateX(5px); }
        .actor i { font-size: 1.5rem; color: #546e7a; width: 30px; text-align: center; }
        .actor-info div:first-child { font-weight: 600; font-size: 0.9rem; }
        .actor-info div:last-child { font-size: 0.75rem; color: #78909c; }

        .actor.enterprise { border-left-color: var(--primary); }
        .actor.admin { border-left-color: var(--admin-color); }
        .actor.public { border-left-color: var(--accent); }

        /* Middle Column: The Platform */
        .platform-col {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .zone-edge { background-color: var(--zone-dmz); min-height: 120px; display: flex; align-items: center; justify-content: space-around; }
        .zone-core { background-color: var(--zone-app); min-height: 300px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; padding-top: 30px; }
        .zone-data { background-color: var(--zone-data); display: flex; justify-content: center; gap: 40px; }

        /* Components */
        .component {
            background: white;
            border: 1px solid #cfd8dc;
            border-radius: 6px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            position: relative;
            z-index: 2;
            width: 160px;
        }
        .comp-icon { font-size: 1.8rem; margin-bottom: 8px; display: block; }
        .comp-name { font-weight: 700; font-size: 0.9rem; color: #263238; }
        .comp-meta { font-size: 0.7rem; color: #78909c; margin-top: 4px; }
        
        /* Right Column: External Systems */
        .external-col {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 40px;
        }
        .ext-system {
            text-align: center;
            padding: 20px;
            border: 1px dashed #90a4ae;
            border-radius: 8px;
            background: #eceff1;
        }

        /* SVG Overlay */
        .connections {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100;
        }

        /* Utility */
        .badge-proto {
            font-size: 0.6rem;
            background: #eceff1;
            padding: 2px 4px;
            border-radius: 4px;
            border: 1px solid #cfd8dc;
            color: #546e7a;
            font-family: monospace;
        }

    </style>
</head>
<body>

    <div class="header">
        <h1>Verza Enterprise Platform Architecture</h1>
        <p>High-Availability Institutional Identity & Verification System</p>
    </div>

    <div class="legend">
        <div class="legend-item"><span class="dot" style="background:var(--primary)"></span> Enterprise Flow</div>
        <div class="legend-item"><span class="dot" style="background:var(--admin-color)"></span> Admin/Gov Flow</div>
        <div class="legend-item"><span class="dot" style="background:var(--accent)"></span> Public/SDK Flow</div>
        <div class="legend-item"><div class="line-sample" style="background:#263238"></div> Synchronous (REST/RPC)</div>
        <div class="legend-item"><div class="line-dashed" style="border-color:#263238"></div> Asynchronous (Events)</div>
    </div>

    <div class="diagram diagram-container">

        <!-- LEFT COLUMN: CONSUMERS -->
        <div class="consumers-col">
            
            <div class="consumer-group" id="grp-enterprise">
                <h3><i class="fa-solid fa-building"></i> Institutions</h3>
                <div class="actor enterprise" id="actor-inst-backend">
                    <i class="fa-solid fa-server"></i>
                    <div class="actor-info">
                        <div>Banking Core</div>
                        <div>API Integration</div>
                    </div>
                </div>
                <div class="actor enterprise" id="actor-inst-dash">
                    <i class="fa-solid fa-chart-line"></i>
                    <div class="actor-info">
                        <div>Ops Dashboard</div>
                        <div>Web Portal</div>
                    </div>
                </div>
            </div>

            <div class="consumer-group" id="grp-admin">
                <h3><i class="fa-solid fa-user-shield"></i> Governance</h3>
                <div class="actor admin" id="actor-admin">
                    <i class="fa-solid fa-gavel"></i>
                    <div class="actor-info">
                        <div>Verza Admins</div>
                        <div>Compliance Officers</div>
                    </div>
                </div>
            </div>

            <div class="consumer-group" id="grp-public">
                <h3><i class="fa-solid fa-users"></i> End Users</h3>
                <div class="actor public" id="actor-mobile">
                    <i class="fa-solid fa-mobile-screen-button"></i>
                    <div class="actor-info">
                        <div>Mobile SDK</div>
                        <div>iOS / Android</div>
                    </div>
                </div>
                <div class="actor public" id="actor-web">
                    <i class="fa-solid fa-laptop"></i>
                    <div class="actor-info">
                        <div>Web App</div>
                        <div>Identity Wallet</div>
                    </div>
                </div>
            </div>

        </div>

        <!-- MIDDLE COLUMN: PLATFORM -->
        <div class="platform-col">

            <!-- DMZ / Edge Layer -->
            <div class="zone zone-edge">
                <div class="zone-label">DMZ / Security Edge</div>
                
                <div class="component" id="comp-gateway">
                    <i class="fa-solid fa-network-wired comp-icon" style="color: #d84315;"></i>
                    <div class="comp-name">API Gateway</div>
                    <div class="comp-meta">Rate Limit • WAF • AuthZ</div>
                    <span class="badge-proto">HTTPS</span>
                </div>

                <div class="component" id="comp-lb">
                    <i class="fa-solid fa-arrows-split-up-and-left comp-icon" style="color: #d84315;"></i>
                    <div class="comp-name">Load Balancer</div>
                    <div class="comp-meta">SSL Termination</div>
                </div>
            </div>

            <!-- Application Core -->
            <div class="zone zone-core">
                <div class="zone-label">Core Application Zone (Private Subnet)</div>

                <!-- Left Core: Monolith & Bridge -->
                <div style="display:flex; flex-direction:column; gap:20px; align-items:center;">
                    <div class="component" id="comp-backend" style="border-top: 4px solid var(--primary);">
                        <i class="fa-brands fa-golang comp-icon" style="color: #0288d1;"></i>
                        <div class="comp-name">Verza Core API</div>
                        <div class="comp-meta">Biz Logic • Inst Mgmt</div>
                        <div class="comp-meta">Audit Logging</div>
                    </div>
                    
                    <div class="component" id="comp-bridge">
                        <i class="fa-solid fa-link comp-icon" style="color: #7b1fa2;"></i>
                        <div class="comp-name">Chain Bridge</div>
                        <div class="comp-meta">Event Listener</div>
                    </div>
                </div>

                <!-- Right Core: Identity Platform -->
                <div style="display:flex; flex-direction:column; gap:20px; align-items:center;">
                     <div class="component" id="comp-orchestrator" style="border-top: 4px solid var(--accent);">
                        <i class="fa-solid fa-gears comp-icon" style="color: #0288d1;"></i>
                        <div class="comp-name">ID Orchestrator</div>
                        <div class="comp-meta">Workflow Engine</div>
                    </div>

                    <div class="component" id="comp-inference">
                        <i class="fa-brands fa-python comp-icon" style="color: #fbc02d;"></i>
                        <div class="comp-name">Inference Engine</div>
                        <div class="comp-meta">ML / CV Analysis</div>
                        <div class="comp-meta">GPU Accelerated</div>
                    </div>
                </div>
            </div>

            <!-- Data Layer -->
            <div class="zone zone-data">
                <div class="zone-label">Persistence & Storage Zone</div>
                
                <div class="component" id="comp-db-core">
                    <i class="fa-solid fa-database comp-icon" style="color: #37474f;"></i>
                    <div class="comp-name">Core DB</div>
                    <div class="comp-meta">PostgreSQL (HA)</div>
                    <div class="comp-meta">Users/Tenants</div>
                </div>

                <div class="component" id="comp-db-id">
                    <i class="fa-solid fa-database comp-icon" style="color: #37474f;"></i>
                    <div class="comp-name">Identity DB</div>
                    <div class="comp-meta">PostgreSQL (HA)</div>
                    <div class="comp-meta">Sessions/Jobs</div>
                </div>

                <div class="component" id="comp-s3">
                    <i class="fa-brands fa-aws comp-icon" style="color: #ff9800;"></i>
                    <div class="comp-name">Encrypted S3</div>
                    <div class="comp-meta">Document Store</div>
                    <div class="comp-meta">KMS Integrated</div>
                </div>
            </div>

        </div>

        <!-- RIGHT COLUMN: EXTERNAL -->
        <div class="external-col">
            
            <div class="ext-system" id="ext-webhooks">
                <i class="fa-solid fa-globe fa-2x"></i>
                <div style="margin-top:10px; font-weight:bold;">Institution Webhooks</div>
                <div style="font-size:0.7rem;">Callback URLs</div>
            </div>

            <div class="ext-system" id="ext-blockchain">
                <i class="fa-brands fa-ethereum fa-2x"></i>
                <div style="margin-top:10px; font-weight:bold;">Public Blockchains</div>
                <div style="font-size:0.7rem;">EVM / Midnight / Cardano</div>
            </div>

            <div class="ext-system" id="ext-stripe">
                <i class="fa-brands fa-stripe fa-2x"></i>
                <div style="margin-top:10px; font-weight:bold;">Payment Rails</div>
                <div style="font-size:0.7rem;">Stripe Connect</div>
            </div>

        </div>

        <svg class="connections"></svg>

    </div>

    <script>
        // Connector Logic
        function drawLine(startId, endId, color, style = 'solid') {
            const start = document.getElementById(startId);
            const end = document.getElementById(endId);
            const svg = document.querySelector('.connections');
            if(!start || !end) return;

            const startRect = start.getBoundingClientRect();
            const endRect = end.getBoundingClientRect();
            const containerRect = document.querySelector('.diagram-container').getBoundingClientRect();

            // Coords relative to container
            const x1 = startRect.right - containerRect.left;
            const y1 = startRect.top + startRect.height/2 - containerRect.top;
            
            const x2 = endRect.left - containerRect.left;
            const y2 = endRect.top + endRect.height/2 - containerRect.top;

            // Adjust for internal vertical connections
            const isVertical = Math.abs(startRect.left - endRect.left) < 100;
            let d = "";

            if (isVertical) {
                const vx1 = startRect.left + startRect.width/2 - containerRect.left;
                const vy1 = startRect.bottom - containerRect.top;
                const vx2 = endRect.left + endRect.width/2 - containerRect.left;
                const vy2 = endRect.top - containerRect.top;
                d = `M ${vx1} ${vy1} L ${vx2} ${vy2}`;
            } else {
                 d = `M ${x1} ${y1} 
                     C ${x1 + 50} ${y1}, ${x2 - 50} ${y2}, ${x2} ${y2}`;
            }

            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
            path.setAttribute("d", d);
            path.setAttribute("stroke", color);
            path.setAttribute("stroke-width", "2");
            path.setAttribute("fill", "none");
            if(style === 'dashed') path.setAttribute("stroke-dasharray", "5,5");
            path.setAttribute("marker-end", `url(#arrow-${color.replace('#','')})`);

            svg.appendChild(path);
        }

        function init() {
            const svg = document.querySelector('.connections');
            svg.innerHTML = `
                <defs>
                    <marker id="arrow-1565c0" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#1565c0"/></marker>
                    <marker id="arrow-c62828" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#c62828"/></marker>
                    <marker id="arrow-2e7d32" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#2e7d32"/></marker>
                    <marker id="arrow-546e7a" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#546e7a"/></marker>
                </defs>
            `;

            // Enterprise Flows (Blue)
            drawLine('actor-inst-backend', 'comp-gateway', '#1565c0');
            drawLine('actor-inst-dash', 'comp-gateway', '#1565c0');
            drawLine('comp-gateway', 'comp-backend', '#1565c0');
            drawLine('comp-backend', 'ext-webhooks', '#1565c0', 'dashed');

            // Admin Flows (Red)
            drawLine('actor-admin', 'comp-gateway', '#c62828');

            // Public Flows (Green)
            drawLine('actor-mobile', 'comp-lb', '#2e7d32');
            drawLine('actor-web', 'comp-lb', '#2e7d32');
            drawLine('comp-lb', 'comp-orchestrator', '#2e7d32'); // Simplified path to Orch via gateway implied
            
            // Internal App Flows (Grey)
            drawLine('comp-backend', 'comp-bridge', '#546e7a');
            drawLine('comp-orchestrator', 'comp-inference', '#546e7a');
            drawLine('comp-bridge', 'ext-blockchain', '#546e7a');
            drawLine('comp-backend', 'ext-stripe', '#546e7a');
            
            // Data Flows (Grey Vertical)
            drawLine('comp-backend', 'comp-db-core', '#546e7a');
            drawLine('comp-orchestrator', 'comp-db-id', '#546e7a');
            drawLine('comp-orchestrator', 'comp-s3', '#546e7a');
        }

        window.onload = init;
        window.onresize = init;
    </script>

</body>
</html>